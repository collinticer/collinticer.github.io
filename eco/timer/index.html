<html>
    <head>
        <title>The Chill Eco Server Reboot Schedule</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    </head>
    <body class="bg-dark text-light">
        <div class="container">
            <p class="lead">
                The Chill Eco Server will automatically reboot next according to the countdown shown below.
            </p>
            <p>
                Server reboots usually only take a minute or two but it's not unheard of for one to take 5 to 10 minutes, especially on longer running cycles.
            </p>
            <p>
                For a more up-to-date status consult the <em>#server-info</em> Discord channel.
            </p>
            <div class="card card-body">
                <div id="demo" class="text-dark"></div>
            </div>
        </div>
    </body>
    <script>

        showRebootCountdown();

        function showRebootCountdown()
        {
            const secondsInHour = 60 * 60;

            const userDate = new Date( new Date().toUTCString() );
            const morningDate = new Date( '2022-09-23T10:30:00Z' );
            const eveningDate = new Date( '2022-09-23T22:30:00Z' );
            
            let userNextDayDate = new Date();
            userNextDayDate.setDate( userDate.getDate() + 1 );//add a day

            const morningRebootSeconds = ( morningDate.getUTCHours() * secondsInHour ) + ( morningDate.getUTCMinutes() * 60 );
            const eveningRebootSeconds = ( eveningDate.getUTCHours() * secondsInHour ) + ( eveningDate.getUTCMinutes() * 60 );

            const userCurrentDaySeconds = ( userDate.getUTCHours() * secondsInHour ) + ( userDate.getUTCMinutes() * 60 );

            let relevantYear = userDate.getUTCFullYear();
            let relevantMonth = ("" + ( userDate.getUTCMonth() + 1) ).padStart( 2, '0' );//+1 since it's zero-index
            let relevantDay = userDate.getDate();

            let relevantHour = morningDate.getUTCHours();
            let relevantMinutes = morningDate.getUTCMinutes();
            let relevantSeconds = ( "" + morningDate.getUTCSeconds() ).padStart( 2, '0' );

            //use morning reboot schedule
            if( userCurrentDaySeconds < morningRebootSeconds )
            {
                relevantHour = morningDate.getUTCHours();
                relevantMinutes = morningDate.getUTCMinutes();
                relevantSeconds = ( "" + morningDate.getUTCSeconds() ).padStart( 2, '0' );
            }
            //use evening reboot schedule
            else if( userCurrentDaySeconds < eveningRebootSeconds )
            {
                relevantHour = eveningDate.getUTCHours();
                relevantMinutes = eveningDate.getUTCMinutes();
                relevantSeconds = ( "" + eveningDate.getUTCSeconds() ).padStart( 2, '0' );
            }
            //use next morning reboot schedule
            else
            {
                relevantYear = userNextDayDate.getUTCFullYear();
                relevantMonth = ("" + ( userNextDayDate.getUTCMonth() + 1) ).padStart( 2, '0' );//+1 since it's zero-index
                relevantDay = userNextDayDate.getDate();

                relevantHour = morningDate.getUTCHours();
                relevantMinutes = morningDate.getUTCMinutes();
                relevantSeconds = ( "" + morningDate.getUTCSeconds() ).padStart( 2, '0' );
            }

            let relevantDate = new Date( relevantYear + '-' + relevantMonth + '-' + relevantDay + 'T' + relevantHour + ':' + relevantMinutes + ':' + relevantSeconds + 'Z' );

            let countDownDate = relevantDate;

            // Update the count down every 1 second
            var x = setInterval(function() {

                // Get today's date and time
                var now = new Date().getTime();

                // Find the distance between now and the count down date
                var distance = countDownDate - now;

                // Time calculations for days, hours, minutes and seconds
                var days = Math.floor(distance / (1000 * 60 * 60 * 24));
                var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                var seconds = Math.floor((distance % (1000 * 60)) / 1000);

                // Display the result in the element with id="demo"
                document.getElementById("demo").innerHTML = days + "d " + hours + "h "
                + minutes + "m " + seconds + "s ";

                // If the count down is finished, write some text
                if (distance < 0) {
                    clearInterval(x);
                    showRebootCountdown();
                }
            }, 1000);
        }
    </script>
</html>